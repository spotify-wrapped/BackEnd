<div class="content-container">

    <h1 class='horizontal-center'>Top Songs</h1>
    <div class='list-container'>
        <div id='songs-list'></div>
    </div>  
    <button class='horizontal-center' onClick="createPlaylist()">Create Playlist</button>
</div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Main -->
<script>
    const accessToken = sessionStorage.getItem('accessToken');
    $( document ).ready(async function(){
        try {
            const { items: topTracks } = await $.post(window.location.origin + '/top', { accessToken });
            displayTracks(topTracks); 
        }catch(err) {
            console.log(err);
            $("#main").append('<div>Please refresh page</div>');
        }
    });
</script>

<!-- Script for displaying top tracks list -->
<script>
    function displayTracks(topTracks){
        topTracks.forEach(track => {
            const { album, artists, id, name } = track;
            const { name: albumName } = album;

            const albumArt = album.images[1];

            $("#songs-list").append('<div class="song-entry" id='+id+'></div>');
            $(`#${id}`).append(`<img class="album-image" src=${albumArt.url} height=75/>`);
            $(`#${id}`).append('<p class="song-text">'+name+' - '+artists[0].name+'</p>');
        });
    }
</script>

<!-- Script for create playlist button -->
<script>
    function createPlaylist(){
        $.post(
            window.location.origin + '/createPlaylist',
            {
                accessToken
            },
            (data, status) => {
                console.log(`Playlist Created! Data: ${data}, Status: ${status}`);
            }
        );
    }
</script>